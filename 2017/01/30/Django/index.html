<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Django | Léo`s Blog</title>
  <meta name="author" content="Léo WENG">
  
  <meta name="description" content="Jan 30 2017
入门">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Django"/>
  <meta property="og:site_name" content="Léo`s Blog"/>

  
    <meta property="og:image" content=""/>
  

  
  
    <link href="/favicon.ico" rel="icon">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/css/themes/flatly.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight-default.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/comment.css" media="screen" type="text/css">
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.7/es5-sham.min.js"></script>
  <![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>
  
  <!-- analytics -->
  



</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="navbar-brand" href="/">Léo`s Blog</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header page-header-inverse ">		
			<h1 class="title title-inverse "> Django</h1>
		</div>		
	






<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <p><code>Jan 30 2017</code></p>
<h1 id="入门"><a href="#入门" class="headerlink" title="入门"></a>入门</h1><a id="more"></a>
<h2 id="开始一个项目"><a href="#开始一个项目" class="headerlink" title="开始一个项目"></a>开始一个项目</h2><p>项目是Django实列的一系列设置集合，包括数据库，setting，和app的设置。<br>运行<code>django-admin.py startproject mysite</code> 会在当前目录下创建一个目录mysite。<br>这个目录包含4个文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysite/</span><br><span class="line">    __init__.py</span><br><span class="line">    mange.py</span><br><span class="line">    settings.py</span><br><span class="line">    urls.py</span><br></pre></td></tr></table></figure>
<p>文件作用：</p>
<ul>
<li><strong>init</strong>.py: 让python把该目录当作一组模块的文件。一遍为空不需要改动。</li>
<li>manage.py: 命令行工具，方便与Django交互，<code>python mange.py help</code> 查看具体作用。</li>
<li>settings.py: 改Django项目的配置文件。</li>
<li>urls.py: Django的url设置。</li>
</ul>
<p>这些文件已经构成了一个可运行的Django应用。</p>
<h2 id="运行开发服务器"><a href="#运行开发服务器" class="headerlink" title="运行开发服务器"></a>运行开发服务器</h2><p><code>python manage.py runserver</code><br>默认下本地服务器地址与端口是<code>http://127.0.0.1:8000/</code>，也可以改变ip地址或端口运行。<br>改变端口：<br><code>python manage.py runserver 8080</code><br>改变ip：<br><code>python manage.py runserver 0.0.0.0:8000</code><br>完成这些设置之后，本地网络内其他终端就可以通过访问你的ip地址访问你的服务器了。</p>
<h1 id="视图与URL配置"><a href="#视图与URL配置" class="headerlink" title="视图与URL配置"></a>视图与URL配置</h1><h2 id="第一份视图"><a href="#第一份视图" class="headerlink" title="第一份视图"></a>第一份视图</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(“Hello world”)</span><br></pre></td></tr></table></figure>
<p>一个视图就是python的一个函数。这个函数的第一个参数类型是HttpResponse；这个函数返回一个HttpResponse的实列。必须满足这两个条件的函数，才是一个Django可识别的视图。</p>
<h2 id="URLconf"><a href="#URLconf" class="headerlink" title="URLconf"></a>URLconf</h2><p>为了绑定视图函数和URL，我们使用URLconf。其本质是URL正则表达式pattern与此表达式需要调用的视图函数之间的映射表。以这种方式使Django明白哪一个url调用哪一个视图表达式。</p>
<h2 id="python-搜索路径"><a href="#python-搜索路径" class="headerlink" title="python 搜索路径"></a>python 搜索路径</h2><p>搜索路径就是<code>import</code> 语句执行时查找系统目录的名单。<br>可通过以下代码显示路径：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">print</span> sys.path</span><br></pre></td></tr></table></figure></p>
<p>通常不必关心搜索路径，python和Django会自动处理。</p>
<h2 id="Django是怎么处理请求的"><a href="#Django是怎么处理请求的" class="headerlink" title="Django是怎么处理请求的"></a>Django是怎么处理请求的</h2><p>当运行<code>python manage.py runserver</code>时，脚步将在于mange同一个目录下找setting.py文件。这个文件包涵了有关Django项目的配置信息，如<code>TEMPLATE_DIRS , DATABASE_NAME</code>等。最重要的是<code>ROOT_URLCONF</code> 它作为URLconf告诉Django哪些python模块将被用到。<br>自动创建的setting.py包含一个指向自动产生的urls.py的配置。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ROOT_URLCONF = <span class="string">'mysite.urls'</span></span><br></pre></td></tr></table></figure>
<p>当服务器被访问时，Django根据ROOT_URLCONF的设置装载URLconf。然后按顺序逐个匹配URLconf里的URLpatterns，直到找到一个匹配的。然后调用这个匹配pattern的view函数，并把HttpRequest对象当作第一参数。这个view函数返回一个HttpResponse，Django将其转化成一个带有HTTP头和body的web Response。</p>
<p>总结:</p>
<ol>
<li>服务器收到访问hello/的请求。 </li>
<li>Django 过 ROOT_URLCONF配置来决定根URLconf. </li>
<li>Django在URLconf中的所有URL模式中查找第一个匹配hello/的条目。</li>
<li>如果找到，调用相应的视图函数。  </li>
<li>视图函数返回一个HttpResponse 。</li>
<li>Django转换HttpResponse为一个合适的HTTPresponse ，以Webpage显示出来。</li>
</ol>
<h1 id="模版"><a href="#模版" class="headerlink" title="模版"></a>模版</h1><h2 id="如何使用模版系统"><a href="#如何使用模版系统" class="headerlink" title="如何使用模版系统"></a>如何使用模版系统</h2><p>python中使用Django模版的最基本方法如下：</p>
<ol>
<li>创建一个template对象<code>template.Template()</code>;</li>
<li>调用模版对象的render方法，并且传入一套变量context。</li>
</ol>
<h2 id="创建模版对象"><a href="#创建模版对象" class="headerlink" title="创建模版对象"></a>创建模版对象</h2><p>Template类在django.template模块中，构造函数接受一个参数，原始模版代码字符串，也可以指定模版文件路径当作参数。<br>启动python交互解释：<br><code>python manage.py shell</code><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">t = Template(<span class="string">'My name is &#123;&#123; name &#125;&#125;.'</span>)</span><br></pre></td></tr></table></figure></p>
<p>创建模版对象之后，可以用context来传递数据给他。一个context是一系列变量和它们值的集合。<br>context是一个django.template模块里的类。她的构造函数带一个可选参数，一个字典，映射便利和它们的值。调用Template对象的render()方法传递context来填充模版。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">t = Template(<span class="string">'My name is &#123;&#123; name &#125;&#125;.'</span>)</span><br><span class="line">c = Context(&#123;<span class="string">'name'</span>: <span class="string">'Stephane'</span>&#125;)</span><br><span class="line">t.render(c)</span><br></pre></td></tr></table></figure></p>
<p><code>t.render(c)</code>返回一个Unicode字符串对象。</p>
<h2 id="模版变量深度访问"><a href="#模版变量深度访问" class="headerlink" title="模版变量深度访问"></a>模版变量深度访问</h2><p>在Django模版中访问复杂的数据结构时用点运算符。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">person = &#123;<span class="string">'name'</span>: <span class="string">'Sally'</span>, <span class="string">'age'</span>: <span class="string">'43'</span>&#125;</span><br><span class="line">t = Template(<span class="string">'&#123;&#123; person.name &#125;&#125; is &#123;&#123; person.age &#125;&#125; years old.'</span>)</span><br><span class="line">c = Context(&#123;<span class="string">'person'</span>: person&#125;)</span><br><span class="line"> t.render(c)</span><br></pre></td></tr></table></figure></p>
<p>点语法也可以用来调用对象方法。例如，每个python字符串都有upper()方法，可以在模版中使用它们。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">t = Template(<span class="string">'&#123;&#123; var &#125;&#125; -- &#123;&#123; var.upper &#125;&#125; -- &#123;&#123; var.isdigit &#125;&#125;'</span>)</span><br></pre></td></tr></table></figure></p>
<p>注意这里调用方法时并没有使用圆括号，也无法给改方法传递参数。你只能调用不需参数的方法。</p>
<h2 id="基本模版标签"><a href="#基本模版标签" class="headerlink" title="基本模版标签"></a>基本模版标签</h2><p>if/else:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">if</span> today_is_weekend %&#125;</span><br><span class="line">       &lt;p&gt;Welcome to the weekend!&lt;/p&gt; </span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure></p>
<p>for:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">for</span> athlete <span class="keyword">in</span> athlete_list %&#125;</span><br><span class="line"> &lt;li&gt;&#123;&#123; athlete.name &#125;&#125;&lt;/li&gt; </span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line">``` </span><br><span class="line">ifequal/ifnotequal:</span><br><span class="line">```python</span><br><span class="line">&#123;% ifequal user currentuser %&#125;</span><br><span class="line">       &lt;h1&gt;Welcome!&lt;/h1&gt;   </span><br><span class="line">&#123;% endifequal %&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="模版加载"><a href="#模版加载" class="headerlink" title="模版加载"></a>模版加载</h2><p>要使用模版加载api，首先必须将模版保存位置告诉Django。<br>打开settings.py找到TEMPLATE_DIRS。该设置告诉Django模版加载机制去哪里查找模版。添加模版存放目录。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TEMPLATE_DIRS = ( <span class="string">'/home/django/mysite/templates'</span>, )</span><br></pre></td></tr></table></figure></p>
<p>注意目录地址后面逗号不可缺少。</p>
<p>完成设置之后就可以使用模版加载功能了。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.template.loader <span class="keyword">import</span> get_template </span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse </span><br><span class="line"><span class="keyword">import</span> datetime </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">current_date</span><span class="params">(request)</span>:</span></span><br><span class="line">    now = datetime.datetime.now() </span><br><span class="line">    t = get_template(<span class="string">'current_datetime.html'</span>) </span><br><span class="line">    html = t.render(Context(&#123;<span class="string">'current_date'</span>: now&#125;)) </span><br><span class="line">    <span class="keyword">return</span> HttpResponse(html)</span><br></pre></td></tr></table></figure></p>
<p>我们使用了<code>django.template.loader.get_template()</code>来加载模版而不是手动加载。该函数以模版名称为参数，在文件系统中找出模块的位置，打开并返回一个编译好的Template对象。</p>
<h2 id="render-to-response-render"><a href="#render-to-response-render" class="headerlink" title="render_to_response()/render()"></a>render_to_response()/render()</h2><p>这是django提供的一条捷径，一次性载入模版渲染并返回。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render_to_response   </span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">current_datetime</span><span class="params">(request)</span>:</span></span><br><span class="line">    now = datetime.datetime.now()</span><br><span class="line">    <span class="keyword">return</span> render_to_response(<span class="string">'current_datetime.html'</span>, &#123;<span class="string">'current_date'</span>: now&#125;)</span><br></pre></td></tr></table></figure></p>
<p><code>render_to_response()</code>的第一个参数必须是使用模版的名称，如果给第二个参数，则是context所使用的字典。</p>
<h1 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h1><h2 id="MVC模式"><a href="#MVC模式" class="headerlink" title="MVC模式"></a>MVC模式</h2><p>Django遵循MVC模式，是一种MVC框架。以下是MVC在Django中的含义，</p>
<ul>
<li>M：数据存取部分，由django数据库层处理。</li>
<li>V：选择哪些数据展示和怎么展示数据，由视图和模版构成。</li>
<li>C：根据用户输入委派视图，由Django根据URLconf设置，对给的URL调用相应的函数。</li>
</ul>
<h2 id="数据库配置"><a href="#数据库配置" class="headerlink" title="数据库配置"></a>数据库配置</h2><p>要使用数据库首先我们要做初始配置。我们要告诉Django使用什么数据库以及如何连接数据库。<br>数据库的配置也是在settings.py里，打开这个文件找到：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">DATABASE_ENGINE = ‘’ // 使用引擎</span><br><span class="line">DATABASE_NAME = ‘’   // 数据库名字</span><br><span class="line">DATABASE_USER = ‘’     </span><br><span class="line">DATABASE_PASSWORD = <span class="string">''</span> </span><br><span class="line">DATABASE_HOST = ‘’     //连接那一台主机的数据库服务器,如果是和Django同一台主机则留空</span><br><span class="line">DATABASE_PORT = ‘’    //端口号</span><br></pre></td></tr></table></figure></p>
<p>我们可以在项目目录下，用<code>python manage.py shell</code>来测试。此命令是以正确的配置启用python交互器的一种方法，使python知道加载那个配置文件获取数据库连接信息。<br>输入以下命令测试数据库是否有配置错误，<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> django.db <span class="keyword">import</span> connection</span><br><span class="line"> &gt;&gt;&gt; cursor = connection.cursor()</span><br></pre></td></tr></table></figure></p>
<h2 id="第一个APP"><a href="#第一个APP" class="headerlink" title="第一个APP"></a>第一个APP</h2><p>现在来创建一个包含模型，视图和Django代码的完整应用。<br>系统对app有一个约定，如果使用了Django的数据库层(模型)，你必须创建一个app。模型必须存放在apps中。<br>在项目目录下输入以下命令创建app：<br><code>python manage.py startapp books</code></p>
<p>这个命令创建了一个books目录生成了一些初始文件。</p>
<h2 id="定义模型"><a href="#定义模型" class="headerlink" title="定义模型"></a>定义模型</h2><p>Django模型是用python代码形式表述的数据在数据库中的定义。</p>
<p>我们看这一个模型的例子：书籍、作者、出版商<br>假定下面概念和关系：</p>
<ul>
<li>作者，有姓名、email</li>
<li>出版商，有名称、地址、所在城市、省份、国家、及网站</li>
<li>书籍，有书名、出版日期。它有一个或多个作者，有一个出版商。</li>
</ul>
<p>用代码描述上述信息，打开用startapp新建的文件夹，打开models.py文件，加入如下代码：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Publisher</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">30</span>)</span><br><span class="line">    address = models.CharField(max_length=<span class="number">50</span>)     </span><br><span class="line">    city = models.CharField(max_length=<span class="number">60</span>)     </span><br><span class="line">    state_province = models.CharField(max_length=<span class="number">30</span>) </span><br><span class="line">    country = models.CharField(max_length=<span class="number">50</span>) </span><br><span class="line">    website = models.URLField() </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Author</span><span class="params">(models.Model)</span>:</span> </span><br><span class="line">    first_name = models.CharField(max_length=<span class="number">30</span>) </span><br><span class="line">    last_name = models.CharField(max_length=<span class="number">40</span>) </span><br><span class="line">    email = models.EmailField() </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Book</span><span class="params">(models.Model)</span>:</span> </span><br><span class="line">    title = models.CharField(max_length=<span class="number">100</span>)    </span><br><span class="line">    authors = models.ManyToManyField(Author) </span><br><span class="line">    publisher = models.ForeignKey(Publisher)        </span><br><span class="line">    publication_date = models.DateField()</span><br></pre></td></tr></table></figure></p>
<p>首先要注意的是每个数据模型都是<code>django.db.models.Model</code>的子类。它们的父类包含了所有必要的和数据库交互的方法，并提供了简洁漂亮的定义数据库字段的语法。<br>每个模型相当于单个数据库表，每个熟悉就是这个表中的一个字段。属性名就是字段名，她的类型相当于数据库的字段类型。</p>
<h2 id="模型安装"><a href="#模型安装" class="headerlink" title="模型安装"></a>模型安装</h2><p>完成代码之后，现在在数据库中创建这些表。第一步，在Django项目中激活这些模型，将book添加到配置文件的以安装应用列表中即可完成此步骤。<br>添加app到settings.py中的INSTALLED_APPS:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = ( </span><br><span class="line"> <span class="comment"># 'django.contrib.auth’, </span></span><br><span class="line"> <span class="comment"># 'django.contrib.contenttypes’, </span></span><br><span class="line"> <span class="comment"># 'django.contrib.sessions’, </span></span><br><span class="line"> <span class="comment"># 'django.contrib.sites’, </span></span><br><span class="line"> <span class="string">'mysite.books'</span>, </span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>现在可以创建数据库表了，首先用下面命令验证模型的有效性，<br><code>python manage.py validate</code></p>
<p>如果模型确认没有问题，通过以下命令可以生成相应的SQL代码<br><code>python manage.py sqlall books</code></p>
<p>sqlall命令根据模型生成相应SQL代码，可以把输出的语句复制到数据库客户端执行，或通过管道直接操作。Django也提供更简单的提交SQL语句到数据库的方法：<br><code>python manage.py syncdb</code></p>
<p>syndb是同步模型到数据库的一个简单方法。它根据INSTALLED_APPS里设置的app来检查数据库，如果表不存在久创建一个表。syndb不能修改或者删除数据库内容。</p>
<h2 id="插入和更新数据"><a href="#插入和更新数据" class="headerlink" title="插入和更新数据"></a>插入和更新数据</h2><p>使用定义的模型生成一个实例对象之后<code>p = Publisher(…)</code>，使用<code>save()</code>方法把这个对象储存到数据库中，如果数据已经储存过了，则实现对数据更新。</p>
<h2 id="选择对象"><a href="#选择对象" class="headerlink" title="选择对象"></a>选择对象</h2><p><code>Publisher.objects.all()</code>可以从给的到模型中取出所有记录。</p>
<p>可以通过filer()过滤出特定的表项数据,结果返回一个匹配到的数据列表：<br><code>Publisher.objects.filter(country=&quot;U.S.A.&quot;, state_province=&quot;CA”)</code></p>
<h2 id="数据排序"><a href="#数据排序" class="headerlink" title="数据排序"></a>数据排序</h2><p><code>Publisher.objects.order_by(&quot;name”)</code><br>使用<code>order_by()</code>方法实现根据字段值对返回结果排序。</p>
<h2 id="更新多个对象"><a href="#更新多个对象" class="headerlink" title="更新多个对象"></a>更新多个对象</h2><p>使用update()方法实现多个对象的更新：<br><code>Publisher.objects.all().update(country=&#39;USA&#39;)</code></p>
<h2 id="删除对象"><a href="#删除对象" class="headerlink" title="删除对象"></a>删除对象</h2><p>使用delete()方法删除表项：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Publisher.objects.filter(country=<span class="string">'USA'</span>).delete()</span><br><span class="line">Publisher.objects.all().delete()</span><br></pre></td></tr></table></figure></p>
<h1 id="站点管理admin"><a href="#站点管理admin" class="headerlink" title="站点管理admin"></a>站点管理admin</h1><h2 id="django-contrib-包"><a href="#django-contrib-包" class="headerlink" title="django.contrib 包"></a>django.contrib 包</h2><p>django.contrib 是一套庞大的功能集，他是django基本代码的组成部分，django框架就是由众多的包含附加组件的基本代码构成的。<br>管理工具是django.contrib.admin 。</p>
<h2 id="激活管理界面"><a href="#激活管理界面" class="headerlink" title="激活管理界面"></a>激活管理界面</h2><p>激活Django管理页面需要以下几个步骤：</p>
<ol>
<li><code>django.contrib.admin</code>被加入了setting的INSTALLED_APPS配置中。</li>
<li>保证INSTALLED_APPS中包含了<code>django.contrib.auth</code>,<code>django.contrib.contenttype</code>,<code>django.contrib.sessions</code>这三个需求包。</li>
<li>确保MIDDLEWARE_CLASSES中包含了<code>django.middleware.common.CommonMiddleware</code>,<code>django.contrib.sessions.middleware.SessionMiddleware</code>,<code>django.contrib.auth.middleware.AuthenticationMiddleware</code>。</li>
</ol>
<p>运行<code>python manage.py syncdb</code> 将生成管理界面使用的额外数据库表。<br>运行<code>python manage.py createsuperuser</code>来创建超级用户。</p>
<p>之后在URLconf中配置admin的url。</p>
<h2 id="将Models加入到Admin管理中"><a href="#将Models加入到Admin管理中" class="headerlink" title="将Models加入到Admin管理中"></a>将Models加入到Admin管理中</h2><p>如果把我们之前建立的models与admin界面连接，我们就可以使用admin的GUI管理我们的数据库了。<br>在目录下创建一个admin.py文件然后输入代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin   </span><br><span class="line"><span class="keyword">from</span> mysite.books.models <span class="keyword">import</span> Publisher, Author, Book</span><br><span class="line"></span><br><span class="line">admin.site.register(Publisher); </span><br><span class="line">admin.site.register(Author); </span><br><span class="line">admin.site.register(Book);</span><br></pre></td></tr></table></figure>
	  
	</div>

	<!-- recommended posts -->
	

	<div>
  	<center>
	<div class="pagination">
<ul class="pagination">
	 
				
    	<li class="prev"><a href="/2017/05/02/Auto-Layout-iOS/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>Prev</a></li>
  		

        <li><a href="/archives"><i class="fa fa-archive"></i>Archive</a></li>

		
		   <li class="next"><a href="/2016/12/19/Python-Study/" class="alignright next">Next<i class="fa fa-arrow-circle-o-right"></i></a></li>         
        
	
</ul>
</div>

    </center>
	</div>

    <!-- share -->
    
        

        

    
	
	<!-- comment -->
	
<section id="comment">
  <h2 class="title">Comments</h2>
  
  	 <div id="disqus_thread">
     <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  	 </div>
  
</section>


	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2017-01-30 
	</div>
	

	<!-- categories -->
    

	<!-- tags -->
	

	<!-- toc -->
	<div class="meta-widget">
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>
		

</div><!-- row -->

<script type="text/javascript">
var disqus_shortname = 'leoweng';
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2018 Léo WENG
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.    
</p> </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>


<!-- syntax highlighting -->


</body>
   </html>
